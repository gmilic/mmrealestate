<style>
  :root {
    --primary-color: #1c2433;
    --secondary-color: #2efd53;
    --light-green: #eefff3;
    --light-black: #313a46;
    --darkd-green: #194035;
  }

  .select-js-elements {
    width: 100%;
    padding: 10px 12px;
    margin: 8px 0;
    display: inline-block;
    border: 1px solid #ccc;
    border-radius: 4px;
    box-sizing: border-box;
    font-family: "Inter", sans-serif;
    background-color: var(--light-green);
    margin-bottom: 2rem;
    border-radius: 8px;
  }

  .h5-js-elements {
    font-size: 1.2rem;
    color: var(--primary-color);
    margin: 0;
    line-height: 1.1;
    font-family: "Inter", sans-serif;
  }
  .h6-js-elements {
    font-size: 1rem;
    font-weight: normal;
    color: var(--primary-color);
    margin: 0 0 0.25rem 0;
    line-height: 1.1;
    font-family: "Inter", sans-serif;
  }
  .payment-plan_items {
    margin-bottom: 2rem;
  }
  .label-js-elements {
    font-size: 1rem;
    font-weight: bold;
    color: var(--primary-color);
    margin: 0;
    line-height: 1.1;
    font-family: "Inter", sans-serif;
  }
  .roi-calc-slider-wrap {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    grid-template-rows: 1fr;
    grid-column-gap: 1rem;
    grid-row-gap: 1rem;
  }
  .roi-calc-buttons-wrap {
    display: flex;
  }
  .roi-calc-button-result {
    background-color: var(--light-black);
    color: #fff;
    border-radius: 10px;
    text-align: left;
    padding: 0.8rem 1rem 0.4rem 1rem;
    margin-right: 0.6rem;
    cursor: default;
  }
  .roi-calc-button-profit-label {
    margin: 0;
  }
  .roi-calc-button-result-main {
    font-size: 2rem;
    font-weight: bold;
    line-height: 1.1;
    margin: 0;
    min-width: 260px;
  }
  .roi-calc-button-result-main-home {
    font-size: 1.6rem;
    font-weight: bold;
    line-height: 1.1;
    margin: 0;
    min-width: 260px;
    color: #fff;
  }
  .roi-calc-button-result-span {
    font-size: 0.9rem;
    font-weight: 400;
    line-height: 1.1;
    margin: 0;
    margin-left: 0.4rem;
    font-style: italic;
  }
  .button-js-elements-black {
    background-color: var(--secondary-color);
    border: 1px solid var(--secondary-color);
    color: var(--primary-color);
    padding: 0 3rem;
    border-radius: 10px;
    font-size: 1.2rem;
    font-weight: bold;
  }
  .button-js-elements-black:hover {
    background-color: var(--primary-color);
    border: 1px solid var(--secondary-color);
    color: var(--secondary-color);
  }
  .slider-js-elements-wrap {
    width: 100%;
    padding: 4rem 2rem 4rem 0;
    position: relative;
  }
  .slider-js-elements-wrap-home {
    padding: 0 0 1rem 0;
    position: relative;
  }
  .slider {
    -webkit-appearance: none;
    appearance: none;
    width: 100%;
    height: 4px;
    background-image: linear-gradient(
      to right,
      var(--darkd-green),
      var(--secondary-color)
    );
    outline: none;
    -webkit-transition: 0.2s;
    transition: opacity 0.2s;
  }
  .slider::-webkit-slider-thumb {
    -webkit-appearance: none;
    appearance: none;
    width: 24px;
    height: 24px;
    background: transparent;
    cursor: grab;
    border-radius: 4px;
    background-image: url("https://uploads-ssl.webflow.com/656f3c6c0f405e41180cd571/6602ee9c354449f54a55974c_mmslider.svg ");
    background-repeat: no-repeat;
    background-size: 24px 24px;
  }

  .slider::-moz-range-thumb {
    width: 24px;
    height: 24px;
    background: transparent;
    cursor: grab;
    border-radius: 4px;
    background-image: url("https://uploads-ssl.webflow.com/656f3c6c0f405e41180cd571/6602ee9c354449f54a55974c_mmslider.svg ");
    background-repeat: no-repeat;
    background-size: 24px 24px;
  }

  .sliderLabel {
    position: absolute;
    top: 8.2rem;
    left: -1rem;
    display: inline-flex;
    align-items: center;
    justify-content: center;
    font-size: 0.9em;
    font-weight: 400;
    /* transition: 366ms cubic-bezier(0.3, 0.6, 0.4, 1.125); */
    color: #fff;
    /* min-width: 2rem; */
  }
  .slider-js-elements-wrap-home .sliderLabel {
    top: -1.6rem;
    background: #fff;
    color: #000;
    padding: 2px 10px;
    border-radius: 10px;
  }

  .sliderMinMaxLabels {
    display: flex;
    justify-content: space-between;
    margin-top: 6px;
  }
  .sliderMinMaxLabelsTitle {
    color: #fff;
    margin: 0;
    font-size: 0.9rem;
    font-weight: 400;
  }
  .sliderMinMaxLabelsSubTitle {
    color: #fff;
    margin: 0;
    font-size: 0.8rem;
    font-weight: 400;
  }
  .sliderMinMaxLabelsEnd {
    text-align: end;
  }
  .labelSmallText {
    font-size: 0.7rem;
    font-weight: 400;
    position: relative;
    top: 2px;
  }
  #roi-calc-button-result-span {
    min-width: 90px;
    display: inline-block;
  }
  #infaltion-trends-select select,
  #savings-select select {
    max-width: 250px;
    margin-bottom: 0;
  }

  /* SPINNER */
  .dropload {
    position: relative;
    display: inline-block; /* or block */
  }

  .dropload::before {
    position: absolute;
    top: 0;
    left: 0;
    display: block;
    width: 100%;
    height: 100%;

    content: "";
    background: url("https://uploads-ssl.webflow.com/656f3c6c0f405e41180cd571/65ccccafe2b75fdda9060ed3_loading.gif")
      no-repeat center;

    opacity: 0;
    visibility: hidden;

    transition: opacity 0.5s;
  }

  .dropload.show::before {
    opacity: 1;
    visibility: visible;
  }
  /* END SPINNER */

  /********************** HOME **************************************/
  .roi-calc-button-profit-label-home {
    color: var(--secondary-color);
    margin-bottom: 24px;
  }
  .roi-calc-button-profit-total-label-home {
    color: var(--secondary-color);
    margin-bottom: 4px;
  }
</style>
<script>
  // Spacing Between Legend and Chart
  const plugin = {
    beforeInit(chart) {
      // Get a reference to the original fit function
      const origFit = chart.legend.fit;
      chart.legend.fit = function fit() {
        origFit.bind(chart.legend)();
        // Change the height to any desired value
        this.height += 20;
      };
    },
  };
  // start Una
  document
    .getElementById("start-una-chat")
    .addEventListener("click", function () {
      document.getElementById("chatbase-bubble-button").click();
    });

  const priceMin = 100000;
  let roi1year = 50;
  let roi2year = 50;
  let roi3year = 50;
  // =================================== Country select for Graphs ===================================
  const homeGraphsSelect = document.getElementById("home-graphs-select");
  let homeGraphsSelectedCountry = "";
  let homeGraphsRoiValue = 0;
  let homeGraphsDepositValue = 0;
  let homeGraphsInflationValue = "";
  let homeGraphsCountryCode = 0;

  homeGraphsSelect.addEventListener("change", function () {
    homeGraphsSelectedCountry = this.value;

    // Select all the country elements in the ROI list
    let countryElements = document.querySelectorAll(
      ".home-roi-calc-country-data .w-dyn-item"
    );

    // Loop through the country elements
    for (let i = 0; i < countryElements.length; i++) {
      // If the country matches the selected country
      if (
        countryElements[i].querySelector(".text-block-161").textContent ===
        homeGraphsSelectedCountry
      ) {
        // Get the corresponding ROI value
        homeGraphsRoiValue = countryElements[i].querySelector(
          ".graphs-data-country-roi"
        ).textContent;
        homeGraphsDepositValue = countryElements[i].querySelector(
          ".graphs-data-country-deposit"
        ).textContent;
        homeGraphsInflationValue = countryElements[i].querySelector(
          ".graphs-data-country-inflation .w-embed"
        ).innerHTML;
        homeGraphsSavingsValue = countryElements[i].querySelector(
          ".graphs-data-country-deposits .w-embed"
        ).innerHTML;
        // create savigsvsreal graph
        let investmentArray = createInvestmentsArray(
          100000, //investment
          36, //months
          homeGraphsRoiValue, // roi1year
          homeGraphsRoiValue, // roi1year
          homeGraphsRoiValue // roi1year
        );
        let savingsArray = createInvestmentsArray(
          100000, //investment
          36, //months
          homeGraphsDepositValue, // roi1year
          homeGraphsDepositValue, // roi1year
          homeGraphsDepositValue // roi1year
        );
        renderSavingsVsRealChart(investmentArray, savingsArray);

        // create inflation graph
        renderInflationGraph(homeGraphsInflationValue);

        // create savings graph
        renderSavingsGraph(homeGraphsSavingsValue);

        break;
      }
    }
  });

  // =================================== Inflation Graphs ===================================
  const inflationGraphWrap = document.getElementById("infaltion-trends-wrap");
  const inflationCanvas = inflationGraphWrap.appendChild(
    document.createElement("canvas")
  );
  inflationCanvas.id = "inflation-chart";
  inflationCanvas.width = "100%";
  inflationCanvas.height = "400px";

  const ctxInflation = document
    .getElementById("inflation-chart")
    .getContext("2d");

  var gradient = ctxInflation.createLinearGradient(0, 0, 0, 400);

  let inflationChart = new Chart(ctxInflation, {
    type: "line", // or 'bar', 'pie', etc.
    data: {
      labels: [], // initialize as empty array
      datasets: [
        {
          label: "Inflation",
          data: [], // initialize as empty array
          fill: false,
          backgroundColor: "#fff",
          borderColor: "#5AB8D5",
          color: "#fff",
        },
      ],
    },
    options: {
      scales: {
        y: {
          beginAtZero: true,
        },
      },
    },
  });

  function renderInflationGraph(tableData) {
    const parser = new DOMParser();
    const doc = parser.parseFromString(tableData, "text/html");
    const tableInflation = doc.body.firstChild;
    const tableInflationRows = tableInflation.querySelectorAll("tr");
    const tableInflationLabels = [];
    const tableInflationValues = [];
    tableInflationRows.forEach((row, index) => {
      if (index > 0) {
        const cells = row.querySelectorAll("td");
        const year = cells[0].textContent;
        const inflation = cells[1].textContent.replace("%", ""); // remove the '%' sign
        tableInflationValues.push(parseFloat(inflation));
        tableInflationLabels.push(parseInt(year));
      }
    });
    inflationChart.data.labels = tableInflationLabels;
    inflationChart.data.datasets[0].data = tableInflationValues;
    inflationChart.update();
  }

  renderInflationGraph(
    document.querySelector(".graphs-data-country-inflation .w-embed").innerHTML
  );

  // =================================== Savings Graphs ===================================
  const savingsGraphWrap = document.getElementById("savings-wrap");
  const savingsCanvas = savingsGraphWrap.appendChild(
    document.createElement("canvas")
  );
  savingsCanvas.id = "savings-chart";
  savingsCanvas.width = "100%";
  savingsCanvas.height = "400px";

  const ctxSavings = document.getElementById("savings-chart").getContext("2d");

  let savingsChart = new Chart(ctxSavings, {
    type: "line",
    data: {
      labels: [],
      datasets: [
        {
          label: "Savings",
          data: [],
          fill: false,
          backgroundColor: "#fff",
          borderColor: "#5AB8D5",
          color: "#fff",
        },
      ],
    },
    options: {
      // plugins: {
      //   legend: {
      //     display: false
      //   }
      // },
      scales: {
        y: {
          beginAtZero: false,
        },
      },
    },
  });

  function renderSavingsGraph(tableData) {
    const parser = new DOMParser();
    const doc = parser.parseFromString(tableData, "text/html");
    const tableSavings = doc.body.firstChild;
    const tableSavingsRows = tableSavings.querySelectorAll("tr");
    const tableSavingsLabels = [];
    const tableSavingsValues = [];
    tableSavingsRows.forEach((row, index) => {
      if (index > 0) {
        const cells = row.querySelectorAll("td");
        const period = cells[0].textContent;
        const deposit1Year = cells[1].textContent.replace("%", ""); // remove the '%' sign
        tableSavingsValues.push(parseFloat(deposit1Year));
        tableSavingsLabels.push(period);
      }
    });
    savingsChart.data.labels = tableSavingsLabels;
    savingsChart.data.datasets[0].data = tableSavingsValues;
    savingsChart.update();
  }

  renderSavingsGraph(
    document.querySelector(".graphs-data-country-deposits .w-embed").innerHTML
  );

  // =================================== Savings vs Real eastateGraphs ===================================
  const savingsVsRealEstateWrap = document.getElementById(
    "tab-saving-vs-real-graph"
  );
  const savingsVsRealCanvas = savingsVsRealEstateWrap.appendChild(
    document.createElement("canvas")
  );
  savingsVsRealCanvas.id = "savingsVsReal-chart";
  savingsVsRealCanvas.width = "100%";
  savingsVsRealCanvas.height = "400px";

  const ctxSavingsVsReal = document
    .getElementById("savingsVsReal-chart")
    .getContext("2d");

  let savingsVsRealReal = parseInt(
    calculateProfitROI(priceMin, 36, roi1year, roi2year, roi3year)
  );
  let savingsVsRealSavings = parseInt(priceMin * 1.14);
  let savingsVsRealValues = [savingsVsRealReal, savingsVsRealSavings];
  let savingsVsRealLabels = [
    `Real estate investment - Profit: ${savingsVsRealReal.toLocaleString()}`,
    `Bank saving - Profit: ${savingsVsRealSavings.toLocaleString()}`,
  ];
  let investmentArray = createInvestmentsArray(
    100000, //investment
    36, //months
    30, // roi1year
    40, // roi1year
    20 // roi1year
  );
  let savingsArray = createInvestmentsArray(
    100000, //investment
    36, //months
    6, // roi1year
    8, // roi1year
    10 // roi1year
  );

  labelsArrayTime = [];
  for (let i = 0; i <= 36; i++) {
    labelsArrayTime.push(i + " months");
  }
  let savingsVsRealChart;
  async function renderSavingsVsRealChart(investmentArray, savingsArray) {
    if (savingsVsRealChart) {
      savingsVsRealChart.destroy();
    }
    savingsVsRealChart = new Chart(ctxSavingsVsReal, {
      type: "line",
      data: {
        labels: labelsArrayTime,
        datasets: [
          {
            label: "Real Estate Investment",
            data: investmentArray,
            fill: false,
            backgroundColor: "#fff",
            borderColor: "#9DEB8F",
            color: "#fff",
          },
          {
            label: "Bank Savings",
            data: savingsArray,
            fill: false,
            backgroundColor: "#fff",
            borderColor: "#5AB8D5",
            color: "#fff",
          },
        ],
      },
      plugins: [plugin],
      options: {
        responsive: true,
        // maintainAspectRatio: false,
        scales: {
          y: {
            beginAtZero: false,
            ticks: {
              callback: function (value, index, values) {
                return value.toLocaleString() + " €"; // Dodaje € iza svake vrijednosti
              },
            },
          },
        },
        plugins: {
          legend: {
            display: true, // Skriva legendu
          },
        },
      },
    });
  }

  renderSavingsVsRealChart(investmentArray, savingsArray);

  function waitingSpinner(t) {
    if (typeof t === "string") {
      t = document.getElementById(t);
    }
    let p = t.parentElement;

    if (!p.classList.contains("dropload")) {
      let w = document.createElement("div");
      w.classList.add("dropload");
      p.insertBefore(w, t);
      w.appendChild(t);
      p = t.parentElement;
    }

    p.classList.toggle("show");
    p.querySelector("select").disabled = p.classList.contains("show");
  }

  // =================================== Commons ===================================

  function calculateProfitROI(
    investment,
    months,
    roi1year,
    roi2year,
    roi3year
  ) {
    let profit = Math.round(investment);
    let currentYearMonths = new Date().getMonth() + 1; // get current month (0-11, hence +1)
    let remainingMonthsThisYear = 12 - currentYearMonths;

    if (months <= remainingMonthsThisYear) {
      profit += investment * (roi1year / 100) * (months / 12);
    } else if (months <= remainingMonthsThisYear + 12) {
      let monthsNextYear = months - remainingMonthsThisYear;
      profit += Math.round(
        investment * (roi1year / 100) * (remainingMonthsThisYear / 12)
      ); // profit for remaining months this year
      profit += Math.round(
        investment * (roi2year / 100) * (monthsNextYear / 12)
      ); // profit for months in next year
    } else {
      let monthsThirdYear = months - remainingMonthsThisYear - 12;
      profit += Math.round(
        investment * (roi1year / 100) * (remainingMonthsThisYear / 12)
      ); // profit for remaining months this year
      profit += Math.round(investment * (roi2year / 100)); // profit for next full year
      profit += Math.round(
        investment * (roi3year / 100) * (monthsThirdYear / 12)
      ); // profit for months in third year
    }

    return Math.round(profit);
  }

  function createInvestmentsArray(
    investment,
    period,
    roi1year,
    roi2year,
    roi3year
  ) {
    let investmentArray = [];
    let currentGain = investment;
    for (let i = 0; i <= period; i++) {
      let currentROI;
      if (i <= 12) {
        currentROI = roi1year / 12;
      } else if (i <= 24) {
        currentROI = roi2year / 12;
      } else {
        currentROI = roi3year / 12;
      }

      let monthlyGain = parseInt(investment * (currentROI / 100));

      currentGain = parseInt(currentGain) + parseInt(monthlyGain);

      investmentArray.push(currentGain);
    }

    return investmentArray;
  }

  // =================================== ROI calc home ===================================
  const homeRoiCalcJs = document.getElementById("home-roi-calc-js");
  const homeRoiCalcCountrySelect = document.getElementById(
    "select-country-roi-calc"
  );

  const priceMinRoi = 0;
  const priceMaxRoi = 1000000;

  let monthsForCalc = 24;
  let roipercentage = 30;

  const roiCalcInner = homeRoiCalcJs.appendChild(document.createElement("div"));

  roiCalcInner.innerHTML = `
  <div class="roi-calc-slider-home-wrap">
    <div class="roi-calc-single-slider">
      <p class="roi-calc-button-profit-label-home">Investment:</p>
      <div class="slider-js-elements-wrap-home">
        <label for="sliderPrice" class="sliderLabel" id="sliderPriceLabel"
          >0</label
        >
        <input
          type="range"
          min=${priceMinRoi}
          max=1000000
          step=1000
          class="slider"
          id="sliderPrice"
        />
        <div class="sliderMinMaxLabels">
          <div class="sliderMinMaxLabelsStart">
            <p class="sliderMinMaxLabelsTitle">${priceMinRoi}</p>
            <p class="sliderMinMaxLabelsSubTitle">Minimum</p>
          </div>
          <div class="sliderMinMaxLabelsEnd">
            <p class="sliderMinMaxLabelsTitle">1M €</p>
            <p class="sliderMinMaxLabelsSubTitle">Maximum</p>
          </div>
        </div>
      </div>
    </div>
    <div class="roi-calc-single-slider">
      <p class="roi-calc-button-profit-label-home">Number of Years:</p>
      <div class="slider-js-elements-wrap-home">
        <input
          type="range"
          min="1"
          max="3"
          value="2"
          class="slider"
          id="sliderTime"
        />
        <label for="sliderPrice" class="sliderLabel" id="sliderTimeLabel"
          >0</label
        >
        <div class="sliderMinMaxLabels">
          <div class="sliderMinMaxLabelsStart">
            <p class="sliderMinMaxLabelsTitle">1Y</p>
            <p class="sliderMinMaxLabelsSubTitle">Start</p>
          </div>
          <div class="sliderMinMaxLabelsEnd">
            <p class="sliderMinMaxLabelsTitle">3Y</p>
            <p class="sliderMinMaxLabelsSubTitle">Finish</p>
          </div>
        </div>
      </div>
    </div>
    <div class="roi-calc-single-slider">
      <p class="roi-calc-button-profit-label-home">Annual ROI:</p>
      <div class="slider-js-elements-wrap-home">
        <input
          type="range"
          min="0"
          max="300"
          value="60"
          class="slider"
          id="sliderROI"
        />
        <label for="sliderROI" class="sliderLabel" id="sliderROILabel"
          >0</label
        >
        <div class="sliderMinMaxLabels">
          <div class="sliderMinMaxLabelsStart">
            <p class="sliderMinMaxLabelsTitle">0%</p>
            <p class="sliderMinMaxLabelsSubTitle">Start</p>
          </div>
          <div class="sliderMinMaxLabelsEnd">
            <p class="sliderMinMaxLabelsTitle">300%</p>
            <p class="sliderMinMaxLabelsSubTitle">Finish</p>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div class="roi-calc-home-results-wrap">
    <p class="roi-calc-button-profit-total-label-home">Target Sales Price:</p>
    <p class="roi-calc-button-result-main-home"><span>€</span><span id="roi-calc-profit"></span></p>
  </div>


  `;

  const roiCalcProfit = document.getElementById("roi-calc-profit");
  const sliderPrice = document.getElementById("sliderPrice");
  const sliderTime = document.getElementById("sliderTime");
  const sliderROI = document.getElementById("sliderROI");
  const sliderPriceLabel = document.getElementById("sliderPriceLabel");
  const sliderTimeLabel = document.getElementById("sliderTimeLabel");
  const sliderROILabel = document.getElementById("sliderROILabel");
  const roiCalcButtonResultSpan = document.getElementById(
    "roi-calc-button-result-span"
  );
  let investment = 500000;

  homeRoiCalcCountrySelect.addEventListener("change", function () {
    let selectedCountry = this.value;

    // Select all the country elements in the ROI list
    let countryElements = document.querySelectorAll(
      ".home-roi-calc-country-data .w-dyn-item"
    );

    // Loop through the country elements
    for (let i = 0; i < countryElements.length; i++) {
      // If the country matches the selected country
      if (
        countryElements[i].querySelector(".text-block-161").textContent ===
        selectedCountry
      ) {
        // Get the corresponding ROI value
        let roiValue = countryElements[i].querySelector(
          ".roi-value-calc-data"
        ).textContent;
        sliderROI.value = roiValue;
        sliderROI.dispatchEvent(new Event("input", { bubbles: true }));
        break;
      }
    }
  });

  // Finesweet CMS Filter config, events, and callbacks
  window.fsAttributes = window.fsAttributes || [];
  window.fsAttributes.push([
    "cmsfilter",
    (filterInstances) => {
      // console.log('cmsfilter Successfully loaded!')

      // The callback passes a `filterInstances` array with all the `CMSFilters` instances on the page.
      const [filterInstance] = filterInstances;

      // The `renderitems` event runs whenever the list renders items after filtering.
      filterInstance.listInstance.on("renderitems", (renderedItems) => {
        // console.log('renderedItems', renderedItems)
        let annularROIforCOuntry =
          document.getElementById("roi-for-country").innerText;

        if (!annularROIforCOuntry) {
          annularROIforCOuntry = 60;
        }

        // add value  annularROIforCOuntry to slider sliderROI and update the value
        sliderROI.value = annularROIforCOuntry;
        sliderROI.dispatchEvent(new Event("input", { bubbles: true }));
      });
    },
  ]);

  sliderPrice.addEventListener("input", () => {
    const { value, min, max, offsetWidth } = sliderPrice;
    investment = value;

    // Add snap effect
    let snapValues = [
      100000, 200000, 300000, 400000, 500000, 600000, 700000, 800000, 900000,
    ];
    let closest = snapValues.reduce((a, b) => {
      return Math.abs(b - investment) < Math.abs(a - investment) ? b : a;
    });

    if (Math.abs(investment - closest) <= 10000) {
      sliderPrice.value = closest;
      investment = closest;
    }

    const percent = ((investment - min) / (max - min)) * 100;
    if (percent > 90) {
      sliderPriceLabel.style.left = "-5rem";
    } else if (percent > 70) {
      sliderPriceLabel.style.left = "-4rem";
    } else if (percent > 10) {
      sliderPriceLabel.style.left = "-2rem";
    } else {
      sliderPriceLabel.style.left = "-1rem";
    }
    const newPosition = percent * (offsetWidth / 100);
    sliderPriceLabel.style.transform = `translateX(${newPosition}px)`;
    sliderPriceLabel.innerHTML =
      investment + ' <span class="labelSmallText">€</span>';

    roiCalcProfit.textContent = calculateProfitROI(
      investment,
      monthsForCalc,
      roipercentage,
      roipercentage,
      roipercentage
    ).toLocaleString();
  });

  sliderTime.addEventListener("input", () => {
    const { value, min, max, offsetWidth } = sliderTime;
    const percent = ((value - min) / (max - min)) * 100;
    sliderTimeLabel.style.left = "-1.5rem";
    const newPosition = percent * (offsetWidth / 100);
    sliderTimeLabel.style.transform = `translateX(${newPosition}px)`;
    sliderTimeLabel.innerHTML =
      value + ' <span class="labelSmallText">years</span>';
    monthsForCalc = value * 12;
    roiCalcProfit.textContent = calculateProfitROI(
      investment,
      monthsForCalc,
      roipercentage,
      roipercentage,
      roipercentage
    ).toLocaleString();
  });
  sliderROI.addEventListener("input", () => {
    const { value, min, max, offsetWidth } = sliderROI;
    const percent = ((value - min) / (max - min)) * 100;
    sliderROILabel.style.left = "-20px";
    const newPosition = percent * (offsetWidth / 100);
    sliderROILabel.style.transform = `translateX(${newPosition}px)`;
    sliderROILabel.innerHTML = value + ' <span class="labelSmallText">%</span>';
    roipercentage = value;
    roiCalcProfit.textContent = calculateProfitROI(
      investment,
      monthsForCalc,
      roipercentage,
      roipercentage,
      roipercentage
    ).toLocaleString();
  });
  sliderPrice.dispatchEvent(new Event("input", { bubbles: true }));
  sliderTime.dispatchEvent(new Event("input", { bubbles: true }));
  sliderROI.dispatchEvent(new Event("input", { bubbles: true }));
  roiCalcProfit.textContent = calculateProfitROI(
    investment,
    monthsForCalc,
    roipercentage,
    roipercentage,
    roipercentage
  ).toLocaleString();
</script>

<script>
  document
    .getElementById("home-submit-widget")
    .addEventListener("click", function (e) {
      e.preventDefault();

      // give me value of select with id="Markets"
      let selectedMarket = document.getElementById("Market").value;
      let selectedBudget = document.getElementById("Budget").value;

      // is checkbox Personal-Use checked
      let personalUse = document.getElementById("Personal-Use").checked;
      let investOnly = document.getElementById("Invest-Only").checked;
      let rental = document.getElementById("Rental").checked;

      let url = `/properties?`;

      if (selectedMarket) {
        // in selectedMarket change spaces with +
        selectedMarket = selectedMarket.replace(/\s/g, "+");
        url += `countries=${selectedMarket}`;
      }

      if (selectedBudget && selectedBudget !== "1.000.000-100.000.000") {
        selectedBudget = selectedBudget
          .replace(/\./g, "")
          .replace(/M/g, "000000");
        let budgetValues = selectedBudget.split("-");
        url += `&price=${budgetValues.join("%2C")}`;
      }

      let purpose = [];

      if (personalUse) {
        purpose.push("Personal+use");
      }

      if (investOnly) {
        purpose.push("Invest+only");
      }

      if (rental) {
        purpose.push("Rental");
      }

      if (purpose.length > 0) {
        url += `&purpose=${purpose.join("%2C")}`;
      }

      // console.log(url)
      window.location.href = url;
    });
</script>

<script>
  // Swiper Home Markets
  $(document).ready(function () {
    var swiperNodesMarkets = "";
    var paginationMarkets = '<div class="swiper-pagination-markets"></div>';
    var next_prev_buttonsMarkets =
      '<div class="swiper-button-prev-markets"></div><div class="swiper-button-next-markets"></div>';
    var swiperNodesMarkets = swiperNodesMarkets.concat(
      paginationMarkets,
      next_prev_buttonsMarkets
    );
    /* loop throw all swipers on the page */
    $(".swiper-home-markets").each(function (index) {
      $(this).append(swiperNodesMarkets);
    });

    const swiperBreakpoints = {
      // when window width is >= 320px
      0: {
        slidesPerView: 1,
        slidesPerGroup: 1,
      },
      // when window width is >= 480px
      478: {
        slidesPerView: 2,
        slidesPerGroup: 2,
      },
      // when window width is >= 640px
      900: {
        slidesPerView: 4,
        slidesPerGroup: 4,
      },
    };

    const swiperHomeMarkets = new Swiper(".swiper-home-markets", {
      effect: "slide",
      slidesPerView: 4,
      visibilityFullFit: true,
      autoResize: false,
      loop: false,
      slidesPerGroup: 4,
      spaceBetween: 20,
      pauseOnMouseEnter: true,
      navigation: {
        nextEl: "#home-markets-right",
        prevEl: "#home-markets-left",
      },
      autoplay: {
        delay: 7000,
      },
      breakpoints: swiperBreakpoints,
    });

    // Swiper Home ROI
    const swiperHomeRoi = new Swiper(".swiper-home-roi", {
      effect: "slide",
      slidesPerView: 4,
      visibilityFullFit: true,
      autoResize: false,
      loop: false,
      slidesPerGroup: 4,
      spaceBetween: 20,
      pauseOnMouseEnter: true,
      navigation: {
        nextEl: "#home-high-roi-right",
        prevEl: "#home-high-roi-left",
      },
      autoplay: {
        delay: 10000,
      },
      breakpoints: swiperBreakpoints,
    });

    //Swiper home citizenship

    const swiperHomeCitizenship = new Swiper(".swiper-home-citizenship", {
      effect: "slide",
      slidesPerView: 4,
      visibilityFullFit: true,
      autoResize: false,
      loop: false,
      slidesPerGroup: 4,
      spaceBetween: 20,
      pauseOnMouseEnter: true,
      navigation: {
        nextEl: "#home-citizenship-right",
        prevEl: "#home-citizenship-left",
      },
      autoplay: {
        delay: 7000,
      },
      breakpoints: swiperBreakpoints,
    });
  });

  // zoom on hover
  $(".div-block-665").on("mouseenter", function () {
    $(this).find(".card-bg-holder").css("transform", "scale(1.05)");
  });
  $(".div-block-665").on("mouseleave", function () {
    $(this).find(".card-bg-holder").css("transform", "scale(1)");
  });
  $(".link-block-4").on("mouseenter", function () {
    $(this).find(".card-bg-holder").css("transform", "scale(1.05)");
  });
  $(".link-block-4").on("mouseleave", function () {
    $(this).find(".card-bg-holder").css("transform", "scale(1)");
  });
  $(".rezidency-and-citizenship_card").on("mouseenter", function () {
    $(this).find(".card-bg-holder").css("transform", "scale(1.05)");
  });
  $(".rezidency-and-citizenship_card").on("mouseleave", function () {
    $(this).find(".card-bg-holder").css("transform", "scale(1)");
  });
</script>
