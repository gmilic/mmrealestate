let euro=Intl.NumberFormat("en-DE",{style:"currency",currency:"EUR"});const startDate=new Date(document.querySelector(".data-start-date").innerHTML),finishDate=new Date(document.querySelector(".data-finish-date").innerHTML),paymentPlanWrap=document.getElementById("property-payment-plan-wrap"),paymentPlan=paymentPlanWrap.appendChild(document.createElement("div"));let months;function calculate(){const e=document.getElementById("main-price").textContent,t=document.getElementById("downpayment-percentage").textContent,a=(e*(t/100)).toFixed(2).toLocaleString(),n=(e-a).toFixed(2).toLocaleString(),s=(n/months).toFixed(2).toLocaleString(),r=(s/e*100).toFixed(2).toLocaleString();let i=lastMonthOfPayment(months,"long");paymentPlan.innerHTML=`\n      <div class="payment-plan_items">\n      <h6 class="h6-js-elements">Downpayment percentage:</h6>\n      <h5 class="h5-js-elements">${t}%</h5>\n      </div>\n      <div class="payment-plan_items">\n      <h6 class="h6-js-elements">Downpayment amount: </h6>\n      <h5 class="h5-js-elements">${euro.format(a)}</h5>\n      </div>\n      <div class="payment-plan_items">\n      <h6 class="h6-js-elements">Remaining amount:</h6>\n      <h5 class="h5-js-elements">${euro.format(n)}</h5>\n      </div>\n      \x3c!--\n      <div class="payment-plan_items">\n      <h6 class="h6-js-elements">3-monthly payment percentage:</h6>\n      <h5 class="h5-js-elements">${(3*r).toFixed(2).toLocaleString()}%</h5>\n      </div>\n      --\x3e\n      <div class="payment-plan_items">\n      <h6 class="h6-js-elements">3-monthly payment:</h6>\n      <h5 class="h5-js-elements">${euro.format(3*s)}</h5>\n      </div>\n      \x3c!--\n      <div class="payment-plan_items">\n      <h6 class="h6-js-elements">6-monthly payment percentage:</h6>\n      <h5 class="h5-js-elements">${(6*r).toFixed(2).toLocaleString()}%</h5>\n      </div>\n      --\x3e\n      <div class="payment-plan_items">\n      <h6 class="h6-js-elements">6-monthly payment:</h6>\n      <h5 class="h5-js-elements">${euro.format(6*s)}</h5>\n      </div>\n      <div class="payment-plan_items">\n      <h6 class="h6-js-elements">Last payment:</h6>\n      <h5 class="h5-js-elements">${i}</h5>\n      </div>\n\n      `}function lastMonthOfPayment(e,t){const a=new Date;return a.setMonth(a.getMonth()+parseInt(e)),lastMonthPaymentDateStr=a.toLocaleDateString("en-DE",{year:"numeric",month:t})}function lastMonthOfPaymentRange(e){const t=new Date,a=[];for(let n=0;n<e;n++)t.setMonth(t.getMonth()+1),a.push(t.toLocaleDateString("en-DE",{year:"numeric",month:"short"}));return a}paymentPlan.classList.add("property-payment-plan"),months=finishDate&&finishDate>new Date?Math.ceil((finishDate.getTime()-(new Date).getTime())/2592e6)-1:36,calculate();const roiCalcWrap=document.getElementById("roi-calc-wrap"),priceMin=document.getElementById("data-price-min").textContent,priceMax=document.getElementById("data-price-max").textContent;let monthsForCalc=months,investment=document.getElementById("main-price").textContent,roi1year=document.getElementById("data-roi").textContent,roi2year=document.getElementById("data-roi-2year").textContent,roi3year=document.getElementById("data-roi-3year").textContent;const roiCalcInner=roiCalcWrap.appendChild(document.createElement("div")),firstMonthROI=lastMonthOfPayment(1,"short"),lastMonthROI=lastMonthOfPayment(monthsForCalc,"short");let monthsArray=lastMonthOfPaymentRange(monthsForCalc),investmentArray=createInvestmentsArray(priceMin,monthsForCalc,roi1year,roi2year,roi3year);const whyInvestGraphWrap=document.getElementById("why-invest-graph-wrap"),canvas=whyInvestGraphWrap.appendChild(document.createElement("canvas"));canvas.id="chart",canvas.width="100%",canvas.height="400px";const ctx=document.getElementById("chart").getContext("2d");(gradient=ctx.createLinearGradient(0,0,0,400)).addColorStop(0,"rgba(1, 255, 72, 0.2)"),gradient.addColorStop(1,"rgba(1, 255, 72, 0.01)"),roiCalcInner.innerHTML=`\n  <div class="roi-calc-slider-wrap">\n    <div class="roi-calc-single-slider">\n      <div class="slider-js-elements-wrap">\n        <div class="sliderMinMaxLabels">\n          <div class="sliderMinMaxLabelsStart">\n            <p class="sliderMinMaxLabelsTitle">${priceMin}</p>\n            <p class="sliderMinMaxLabelsSubTitle">Minimum</p>\n          </div>\n          <div class="sliderMinMaxLabelsEnd">\n            <p class="sliderMinMaxLabelsTitle">1M €</p>\n            <p class="sliderMinMaxLabelsSubTitle">Maximum</p>\n          </div>\n        </div>\n        <input\n          type="range"\n          min=${priceMin}\n          max=1000000\n          step=1000\n          class="slider"\n          id="sliderPrice"\n        />\n        <label for="sliderPrice" class="sliderLabel" id="sliderPriceLabel"\n          >0</label\n        >\n      </div>\n    </div>\n    <div class="roi-calc-single-slider">\n      <div class="slider-js-elements-wrap">\n        <div class="sliderMinMaxLabels">\n          <div class="sliderMinMaxLabelsStart">\n            <p class="sliderMinMaxLabelsTitle">${firstMonthROI}</p>\n            <p class="sliderMinMaxLabelsSubTitle">Start</p>\n          </div>\n          <div class="sliderMinMaxLabelsEnd">\n            <p class="sliderMinMaxLabelsTitle">${lastMonthROI}</p>\n            <p class="sliderMinMaxLabelsSubTitle">Finish</p>\n          </div>\n        </div>\n        <input\n          type="range"\n          min="1"\n          max=${monthsForCalc}\n          value=${monthsForCalc}\n          class="slider"\n          id="sliderTime"\n        />\n        <label for="sliderPrice" class="sliderLabel" id="sliderTimeLabel"\n          >0</label\n        >\n      </div>\n    </div>\n  </div>\n\n\n  `;const sliderPrice=document.getElementById("sliderPrice"),sliderTime=document.getElementById("sliderTime"),roiCalcProfit=document.getElementById("roi-calc-profit"),sliderPriceLabel=document.getElementById("sliderPriceLabel"),sliderTimeLabel=document.getElementById("sliderTimeLabel"),roiCalcButtonResultSpan=document.getElementById("roi-calc-button-result-span"),roiChart=new Chart(ctx,{type:"line",data:{labels:monthsArray,datasets:[{data:investmentArray,borderWidth:2,borderColor:["#000"],borrderCapStyle:"round",fill:!0,backgroundColor:gradient,borderDash:[3,5],pointRadius:0,arrowHeads:{width:10,length:10,frequency:"end"}}]},options:{plugins:{legend:{display:!1}},scales:{y:{beginAtZero:!1}}}}),savingsVsRealEstateWrap=document.getElementById("tab-saving-vs-real-graph"),savingsVsRealCanvas=savingsVsRealEstateWrap.appendChild(document.createElement("canvas"));savingsVsRealCanvas.id="savingsVsReal-chart",savingsVsRealCanvas.width="100%",savingsVsRealCanvas.height="400px";const ctxSavingsVsReal=document.getElementById("savingsVsReal-chart").getContext("2d");let savingsVsRealReal=parseInt(calculateProfitROI(priceMin,36,roi1year,roi2year,roi3year)),savingsVsRealSavings=parseInt(1.14*priceMin),savingsVsRealValues=[savingsVsRealReal,savingsVsRealSavings],savingsVsRealLabels=[`Real estate investment - Profit: ${savingsVsRealReal.toLocaleString()}`,`Bank saving - Profit: ${savingsVsRealSavings.toLocaleString()}`],investmentArraySavingsVsReal=createInvestmentsArray(priceMin,36,roi1year,roi2year,roi3year),savingsArray=createInvestmentsArray(priceMin,36,6,8,10);labelsArrayTime=[];for(let e=0;e<=36;e++)labelsArrayTime.push(e+" months");function createInvestmentsArray(e,t,a,n,s){let r=[],i=e;for(let l=0;l<=t;l++){let t;t=l<=12?a/12:l<=24?n/12:s/12;let o=parseInt(e*(t/100));i=parseInt(i)+parseInt(o),r.push(i)}return r}savingsVsRealChart=new Chart(ctxSavingsVsReal,{type:"line",data:{labels:labelsArrayTime,datasets:[{label:"Real Estate Investment",data:investmentArraySavingsVsReal,fill:!1,backgroundColor:"#fff",borderColor:"#9DEB8F",color:"#fff"},{label:"Bank Savings",data:savingsArray,fill:!1,backgroundColor:"#fff",borderColor:"#5AB8D5",color:"#fff"}]},options:{responsive:!0,maintainAspectRatio:!1,scales:{y:{beginAtZero:!1,ticks:{callback:function(e,t,a){return e.toLocaleString()+" €"}}}},plugins:{legend:{display:!0}}}}),sliderPrice.addEventListener("input",(()=>{let{value:e,min:t,max:a,offsetWidth:n}=sliderPrice,s=e,r=[1e5,2e5,3e5,4e5,5e5,6e5,7e5,8e5,9e5].reduce(((e,t)=>Math.abs(t-s)<Math.abs(e-s)?t:e));Math.abs(s-r)<=1e4&&(sliderPrice.value=r,s=r,e=r);const i=(e-t)/(a-t)*100;sliderPriceLabel.style.left=i>90?"-6rem":i>50?"-4rem":i>10?"-2rem":"-1rem";const l=i*(n/100);sliderPriceLabel.style.transform=`translateX(${l}px)`,sliderPriceLabel.textContent=e,investmentArray=createInvestmentsArray(s,monthsForCalc,roi1year,roi2year,roi3year),savingsArray=createInvestmentsArray(s,monthsForCalc,6,8,10),roiChart.data.datasets[0].data=investmentArray,roiChart.update(),savingsVsRealChart.data.datasets[0].data=investmentArray,savingsVsRealChart.data.datasets[1].data=savingsArray,savingsVsRealChart.update(),roiCalcProfit.textContent=calculateProfitROI(s,monthsForCalc,roi1year,roi2year,roi3year).toLocaleString()})),sliderTime.addEventListener("input",(()=>{const{value:e,min:t,max:a,offsetWidth:n}=sliderTime,s=(e-t)/(a-t)*100;sliderTimeLabel.style.left=s>90?"-4rem":s>50?"-3rem":s>10?"-2rem":"-0.5rem";const r=s*(n/100);sliderTimeLabel.style.transform=`translateX(${r}px)`,sliderTimeLabel.innerHTML=e+' <span class="labelSmallText">months</span>',roiCalcButtonResultSpan.textContent=`in ${e} months`,monthsForCalc=e,monthsArray=lastMonthOfPaymentRange(e),roiChart.data.labels=monthsArray,investmentArray=createInvestmentsArray(investment,monthsForCalc,roi1year,roi2year,roi3year),roiChart.data.datasets[0].data=investmentArray,roiChart.data.labels=monthsArray,roiChart.update(),roiCalcProfit.textContent=calculateProfitROI(investment,monthsForCalc,roi1year,roi2year,roi3year).toLocaleString()})),sliderPrice.dispatchEvent(new Event("input",{bubbles:!0})),sliderTime.dispatchEvent(new Event("input",{bubbles:!0})),mapboxgl.accessToken="pk.eyJ1IjoibW1yZWFsZXN0YXRldGVjaCIsImEiOiJjbHB3bjVsZ2EwZzByMm9wYmVtZDVwb2hyIn0.d66L0eAH0VLt2CvD8stQlw";const pitchMap=60,latitude=document.getElementById("data-latitude").textContent,longitude=document.getElementById("data-longitude").textContent,map=new mapboxgl.Map({container:"property-map-wrap",center:[longitude,latitude],zoom:16,style:"mapbox://styles/mmrealestatetech/clvdp45qa00ku01qz7wx0gymq",pitch:60}),marker1=(new mapboxgl.Marker).setLngLat([longitude,latitude]).addTo(map),countryCode=document.querySelector(".data-country-code").textContent.trim();let inflationURL=`https://api.worldbank.org/v2/country/${countryCode}/indicator/NY.GDP.DEFL.KD.ZG?format=json`,inflationChart="";async function getInflationData(){const e=await fetch(inflationURL,{method:"GET",headers:{Accept:"application/json"}});if(e.ok){return await e.json()}}getInflationData().then((e=>{renderInflationJSON(parseWorldData(e))}));const inflationGraphWrap=document.getElementById("infaltion-trends-wrap"),inflationCanvas=inflationGraphWrap.appendChild(document.createElement("canvas"));inflationCanvas.id="inflation-chart",inflationCanvas.width="100%",inflationCanvas.height="400px";const ctxInflation=document.getElementById("inflation-chart").getContext("2d");var gradient=ctxInflation.createLinearGradient(0,0,0,400);function parseWorldData(e){const t=e[1].filter((e=>null!==e.value)),a=t.map((e=>e.date));a.reverse();const n=t.map((e=>e.value));return n.reverse(),[a,n]}async function renderInflationJSON(e){inflationChart=new Chart(ctxInflation,{type:"line",data:{labels:e[0],datasets:[{data:e[1],borderWidth:2,borderColor:["#2efd53"],borrderCapStyle:"round",fill:!0,backgroundColor:gradient,pointRadius:4,pointStyle:"circle",arrowHeads:{width:10,length:10,frequency:"end"}}]},options:{plugins:{legend:{display:!1}},scales:{y:{beginAtZero:!1}}}})}let savingsURL=`https://api.worldbank.org/v2/country/${countryCode}/indicator/FR.INR.DPST?format=json`,savingsChart="";async function getSavingsData(){const e=await fetch(savingsURL,{method:"GET",headers:{Accept:"application/json"}});if(e.ok){return await e.json()}}getSavingsData().then((e=>{renderSavingsJSON(parseWorldData(e))}));const savingsGraphWrap=document.getElementById("savings-wrap"),savingsCanvas=savingsGraphWrap.appendChild(document.createElement("canvas"));savingsCanvas.id="savings-chart",savingsCanvas.width="100%",savingsCanvas.height="400px";const ctxSavings=document.getElementById("savings-chart").getContext("2d");gradient=ctxSavings.createLinearGradient(0,0,0,400);async function renderSavingsJSON(e){savingsChart=new Chart(ctxSavings,{type:"line",data:{labels:e[0],datasets:[{data:e[1],borderWidth:2,borderColor:["#2efd53"],borrderCapStyle:"round",fill:!0,backgroundColor:gradient,pointRadius:4,pointStyle:"circle",arrowHeads:{width:10,length:10,frequency:"end"}}]},options:{plugins:{legend:{display:!1}},scales:{y:{beginAtZero:!1}}}})}function waitingSpinner(e){"string"==typeof e&&(e=document.getElementById(e));let t=e.parentElement;if(!t.classList.contains("dropload")){let a=document.createElement("div");a.classList.add("dropload"),t.insertBefore(a,e),a.appendChild(e),t=e.parentElement}t.classList.toggle("show"),t.querySelector("select").disabled=t.classList.contains("show")}function calculateProfitROI(e,t,a,n,s){let r=Math.round(e),i=12-((new Date).getMonth()+1);if(t<=i)r+=e*(a/100)*(t/12);else if(t<=i+12){let s=t-i;r+=Math.round(e*(a/100)*(i/12)),r+=Math.round(e*(n/100)*(s/12))}else{let l=t-i-12;r+=Math.round(e*(a/100)*(i/12)),r+=Math.round(e*(n/100)),r+=Math.round(e*(s/100)*(l/12))}return Math.round(r)}const timeCounters=document.querySelectorAll(".roi-time-counter");function timeCounterTicker(){let e=new Date,t=new Date(e.getFullYear(),e.getMonth()+1,0)-e,a=Math.floor(t/864e5),n=Math.floor(t%864e5/36e5),s=Math.floor(t%36e5/6e4),r=Math.floor(t%6e4/1e3);timeCounters.forEach((e=>{e.innerHTML=`${a}d ${n}h ${s}m ${r}s`}))}setInterval(timeCounterTicker,1e3);