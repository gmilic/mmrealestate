<style>
  :root {
    --primary-color: #1c2433;
    --secondary-color: #2efd53;
    --light-green: #eefff3;
    --light-black: #313a46;
    --darkd-green: #194035;
  }

  .select-js-elements {
    width: 100%;
    padding: 10px 12px;
    margin: 8px 0;
    display: inline-block;
    border: 1px solid #ccc;
    border-radius: 4px;
    box-sizing: border-box;
    font-family: 'Inter', sans-serif;
    background-color: var(--light-green);
    margin-bottom: 2rem;
    border-radius: 8px;
  }

  .h5-js-elements {
    font-size: 1.2rem;
    color: var(--primary-color);
    margin: 0;
    line-height: 1.1;
    font-family: 'Inter', sans-serif;
  }
  .h6-js-elements {
    font-size: 1rem;
    font-weight: normal;
    color: var(--primary-color);
    margin: 0 0 0.25rem 0;
    line-height: 1.1;
    font-family: 'Inter', sans-serif;
  }
  .payment-plan_items {
    margin-bottom: 2rem;
  }
  .label-js-elements {
    font-size: 1rem;
    font-weight: bold;
    color: var(--primary-color);
    margin: 0;
    line-height: 1.1;
    font-family: 'Inter', sans-serif;
  }
  .roi-calc-slider-wrap {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    grid-template-rows: 1fr;
    grid-column-gap: 1rem;
    grid-row-gap: 1rem;
  }
  .roi-calc-buttons-wrap {
    display: flex;
  }
  .roi-calc-button-result {
    background-color: var(--light-black);
    color: #fff;
    border-radius: 10px;
    text-align: left;
    padding: 0.8rem 1rem 0.4rem 1rem;
    margin-right: 0.6rem;
    cursor: default;
  }
  .roi-calc-button-profit-label {
    margin: 0;
  }
  .roi-calc-button-result-main {
    font-size: 2rem;
    font-weight: bold;
    line-height: 1.1;
    margin: 0;
    min-width: 260px;
  }
  .roi-calc-button-result-span {
    font-size: 0.9rem;
    font-weight: 400;
    line-height: 1.1;
    margin: 0;
    margin-left: 0.4rem;
    font-style: italic;
  }
  .button-js-elements-black {
    background-color: var(--secondary-color);
    border: 1px solid var(--secondary-color);
    color: var(--primary-color);
    padding: 0 3rem;
    border-radius: 10px;
    font-size: 1.2rem;
    font-weight: bold;
  }
  .button-js-elements-black:hover {
    background-color: var(--primary-color);
    border: 1px solid var(--secondary-color);
    color: var(--secondary-color);
  }
  .slider-js-elements-wrap {
    width: 100%;
    padding: 4rem 2rem 4rem 0;
    position: relative;
  }
  .slider-js-elements-wrap .slider {
    -webkit-appearance: none;
    appearance: none;
    width: 100%;
    height: 4px;
    background-image: linear-gradient(
      to right,
      var(--darkd-green),
      var(--secondary-color)
    );
    outline: none;
    -webkit-transition: 0.2s;
    transition: opacity 0.2s;
  }
  .slider-js-elements-wrap .slider::-webkit-slider-thumb {
    -webkit-appearance: none;
    appearance: none;
    width: 8px;
    height: 25px;
    background: #fff;
    cursor: grab;
  }

  .slider-js-elements-wrap .slider::-moz-range-thumb {
    width: 8px;
    height: 25px;
    background: #fff;
    cursor: grab;
  }

  .sliderLabel {
    position: absolute;
    top: 8.2rem;
    left: -1rem;
    display: inline-flex;
    align-items: center;
    justify-content: center;
    font-size: 1.6em;
    /* transition: 366ms cubic-bezier(0.3, 0.6, 0.4, 1.125); */
    color: #fff;
    /* min-width: 2rem; */
  }
  .sliderMinMaxLabels {
    display: flex;
    justify-content: space-between;
  }
  .sliderMinMaxLabelsTitle {
    color: #fff;
    margin: 0;
    font-size: 1.2rem;
    font-weight: bold;
  }
  .sliderMinMaxLabelsSubTitle {
    color: #fff;
    margin: 0;
    font-size: 0.8rem;
    font-weight: 400;
  }
  .sliderMinMaxLabelsEnd {
    text-align: end;
  }
  .labelSmallText {
    font-size: 0.8rem;
    font-weight: 400;
    position: relative;
    top: 5px;
  }
  #roi-calc-button-result-span {
    min-width: 90px;
    display: inline-block;
  }
  #infaltion-trends-select select,
  #savings-select select {
    max-width: 250px;
    margin-bottom: 0;
  }

  /* SPINNER */
  .dropload {
    position: relative;
    display: inline-block; /* or block */
  }

  .dropload::before {
    position: absolute;
    top: 0;
    left: 0;
    display: block;
    width: 100%;
    height: 100%;

    content: '';
    background: url('https://uploads-ssl.webflow.com/656f3c6c0f405e41180cd571/65ccccafe2b75fdda9060ed3_loading.gif')
      no-repeat center;

    opacity: 0;
    visibility: hidden;

    transition: opacity 0.5s;
  }

  .dropload.show::before {
    opacity: 1;
    visibility: visible;
  }
  /* END SPINNER */

  /********************** HOME **************************************/
</style>
<script>
  const priceMin = 100000
  let roi1year = 50
  let roi2year = 50
  let roi3year = 50
  // =================================== Inflation Graphs ===================================
  const inflationSavingsSelectOptions = {
    ba: 'Bosnia and Herzegovina',
    tr: 'Turkiye'
  }
  let inflationURL =
    'https://api.worldbank.org/v2/country/ba/indicator/NY.GDP.DEFL.KD.ZG?format=json'
  let inflationChart = ''
  const inflationSelecthWrap = document.getElementById(
    'infaltion-trends-select'
  )
  const inflationSelect = inflationSelecthWrap.appendChild(
    document.createElement('select')
  )
  inflationSelect.classList.add('select-js-elements')
  inflationSelect.id = 'inflation-select'

  // create options for select
  for (const [key, value] of Object.entries(inflationSavingsSelectOptions)) {
    const optionEl = inflationSelect.appendChild(
      document.createElement('option')
    )
    optionEl.value = key
    optionEl.textContent = value
  }

  inflationSelect.addEventListener('change', function () {
    waitingSpinner('inflation-select')

    inflationURL = `https://api.worldbank.org/v2/country/${this.value}/indicator/NY.GDP.DEFL.KD.ZG?format=json`

    getInflationData().then((data) => {
      let newData = parseWorldData(data)
      inflationChart.data.labels = newData[0]
      inflationChart.data.datasets[0].data = newData[1]
      inflationChart.update()
    })

    waitingSpinner('inflation-select')
  })

  getInflationData().then((data) => {
    renderInflationJSON(parseWorldData(data))
  })

  async function getInflationData() {
    const response = await fetch(inflationURL, {
      method: 'GET',
      headers: {
        Accept: 'application/json'
      }
    })

    if (!response.ok) {
      // handle error
      console.error('HTTP error', response.status)
    } else {
      const apiJSON = await response.json()
      return apiJSON
    }
  }

  const inflationGraphWrap = document.getElementById('infaltion-trends-wrap')
  const inflationCanvas = inflationGraphWrap.appendChild(
    document.createElement('canvas')
  )
  inflationCanvas.id = 'inflation-chart'
  inflationCanvas.width = '100%'
  inflationCanvas.height = '400px'

  const ctxInflation = document
    .getElementById('inflation-chart')
    .getContext('2d')

  var gradient = ctxInflation.createLinearGradient(0, 0, 0, 400)

  function parseWorldData(apiJSON) {
    const inflationData = apiJSON[1].filter((item) => item.value !== null)
    const inflationYears = inflationData.map((item) => item.date)
    inflationYears.reverse()
    const inflationValues = inflationData.map((item) => item.value)
    inflationValues.reverse()
    return [inflationYears, inflationValues]
  }

  async function renderInflationJSON(worldData) {
    inflationChart = new Chart(ctxInflation, {
      type: 'line',
      data: {
        labels: worldData[0],
        datasets: [
          {
            data: worldData[1],
            borderWidth: 2,
            borderColor: ['#2efd53'],
            borrderCapStyle: 'round',
            fill: true,
            backgroundColor: gradient,
            pointRadius: 0, // hide points
            arrowHeads: {
              width: 10,
              length: 10,
              frequency: 'end'
            }
          }
        ]
      },
      options: {
        plugins: {
          legend: {
            display: false
          }
        },
        scales: {
          y: {
            beginAtZero: false
          }
        }
      }
    })
  }

  // =================================== Savings Graphs ===================================
  let savingsURL =
    'https://api.worldbank.org/v2/country/ba/indicator/FR.INR.DPST?format=json'
  let savingsChart = ''
  const savingsSelecthWrap = document.getElementById('savings-select')
  const savingsSelect = savingsSelecthWrap.appendChild(
    document.createElement('select')
  )
  savingsSelect.classList.add('select-js-elements')

  // create options for select
  for (const [key, value] of Object.entries(inflationSavingsSelectOptions)) {
    const optionEl = savingsSelect.appendChild(document.createElement('option'))
    optionEl.value = key
    optionEl.textContent = value
  }

  savingsSelect.addEventListener('change', function () {
    waitingSpinner(this)
    savingsURL = `https://api.worldbank.org/v2/country/${this.value}/indicator/FR.INR.DPST?format=json`

    getSavingsData().then((data) => {
      let newData = parseWorldData(data)
      savingsChart.data.labels = newData[0]
      savingsChart.data.datasets[0].data = newData[1]
      savingsChart.update()
    })
    waitingSpinner(this)
  })

  getSavingsData().then((data) => {
    renderSavingsJSON(parseWorldData(data))
  })

  async function getSavingsData() {
    const response = await fetch(savingsURL, {
      method: 'GET',
      headers: {
        Accept: 'application/json'
      }
    })

    if (!response.ok) {
      // handle error
      console.error('HTTP error', response.status)
    } else {
      const apiJSON = await response.json()
      return apiJSON
    }
  }

  const savingsGraphWrap = document.getElementById('savings-wrap')
  const savingsCanvas = savingsGraphWrap.appendChild(
    document.createElement('canvas')
  )
  savingsCanvas.id = 'savings-chart'
  savingsCanvas.width = '100%'
  savingsCanvas.height = '400px'

  const ctxSavings = document.getElementById('savings-chart').getContext('2d')

  var gradient = ctxSavings.createLinearGradient(0, 0, 0, 400)

  async function renderSavingsJSON(worldData) {
    savingsChart = new Chart(ctxSavings, {
      type: 'line',
      data: {
        labels: worldData[0],
        datasets: [
          {
            data: worldData[1],
            borderWidth: 2,
            borderColor: ['#2efd53'],
            borrderCapStyle: 'round',
            fill: true,
            backgroundColor: gradient,
            pointRadius: 0, // hide points
            arrowHeads: {
              width: 10,
              length: 10,
              frequency: 'end'
            }
          }
        ]
      },
      options: {
        plugins: {
          legend: {
            display: false
          }
        },
        scales: {
          y: {
            beginAtZero: false
          }
        }
      }
    })
  }
  // =================================== Savings vs Real eastateGraphs ===================================
  const savingsVsRealEstateWrap = document.getElementById(
    'tab-saving-vs-real-graph'
  )
  const savingsVsRealCanvas = savingsVsRealEstateWrap.appendChild(
    document.createElement('canvas')
  )
  savingsVsRealCanvas.id = 'savingsVsReal-chart'
  savingsVsRealCanvas.width = '100%'
  savingsVsRealCanvas.height = '100px'

  const ctxSavingsVsReal = document
    .getElementById('savingsVsReal-chart')
    .getContext('2d')

  let savingsVsRealReal = parseInt(
    calculateProfitROI(priceMin, 36, roi1year, roi2year, roi3year)
  )
  let savingsVsRealSavings = parseInt(priceMin * 1.14)
  let savingsVsRealValues = [savingsVsRealReal, savingsVsRealSavings]
  let savingsVsRealLabels = [
    `Real estate investment - Profit: ${savingsVsRealReal.toLocaleString()}`,
    `Bank saving - Profit: ${savingsVsRealSavings.toLocaleString()}`
  ]
  savingsVsRealChart = new Chart(ctxSavingsVsReal, {
    type: 'bar',
    data: {
      labels: savingsVsRealLabels,
      datasets: [
        {
          label: '',
          data: savingsVsRealValues,
          fill: true,
          backgroundColor: ['#99FFB6', '#E8E9EB'],
          color: '#000',
          borderRadius: 20
        }
      ]
    },
    options: {
      indexAxis: 'y',
      maintainAspectRatio: false,
      plugins: {
        legend: {
          display: false
        }
      },
      scales: {
        y: {
          ticks: {
            mirror: true,
            z: 1,
            color: '#000',
            font: {
              size: 15,
              family: "'Inter', 'Arial', sans-serif",
              weight: 'bold'
            }
          },
          position: 'center'
        }
      }
    }
  })

  function waitingSpinner(t) {
    if (typeof t === 'string') {
      t = document.getElementById(t)
    }
    let p = t.parentElement

    if (!p.classList.contains('dropload')) {
      let w = document.createElement('div')
      w.classList.add('dropload')
      p.insertBefore(w, t)
      w.appendChild(t)
      p = t.parentElement
    }

    p.classList.toggle('show')
    p.querySelector('select').disabled = p.classList.contains('show')
  }

  // =================================== Commons ===================================
  function calculateProfitROI(
    investment,
    months,
    roi1year,
    roi2year,
    roi3year
  ) {
    let profit = 0
    let profit1year = 0
    let profit2year = 0
    let profit3year = 0
    if (months <= 12) {
      profit = investment * (roi1year / 100) * (months / 12)
    } else if (months > 12 && months <= 24) {
      profit1year = investment * (roi1year / 100)
      profit2year = investment * (roi2year / 100) * ((months - 12) / 12)
      profit = profit1year + profit2year
    } else if (months > 24) {
      profit1year = investment * (roi1year / 100)
      profit2year = investment * (roi2year / 100)
      profit3year = investment * (roi3year / 100) * ((months - 24) / 12)
      profit = profit1year + profit2year + profit3year
    }
    return Math.round(profit)
  }
</script>
